{"remainingRequest":"e:\\全栈\\semester_03\\semester_03\\day04\\storedes\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!e:\\全栈\\semester_03\\semester_03\\day04\\storedes\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"e:\\全栈\\semester_03\\semester_03\\day04\\storedes\\src\\views\\Home.vue","mtime":1573541474499},{"path":"e:\\全栈\\semester_03\\semester_03\\day04\\storedes\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day04\\storedes\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day04\\storedes\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day04\\storedes\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBNdXRhdGlvbnMgfSBmcm9tICd2dWV4Jw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgc2xpZGVzaG93TGlzdDogW10sDQogICAgICBnb29kc0NsYXNzZXM6IFtdLA0KICAgICAgZ29vZHNMaXN0czogW10sDQogICAgICBsb2FkaW5nOiBmYWxzZSwNCiAgICAgIGZpbmlzaGVkOiBmYWxzZSwNCiAgICAgIHBhZ2U6IDEsDQogICAgICBwZXJfcGFnZTogMjANCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAuLi5tYXBNdXRhdGlvbnMoWydjYXJ0TnVtQ2hhbmdlJ10pLA0KICAgIG9uTG9hZCAoKSB7DQogICAgICAvLyDosIPnlKjmjqXlj6Pojrflj5bpppbpobXllYblk4HliJfooagNCiAgICAgIHRoaXMuJGh0dHANCiAgICAgICAgLmdldChgL2luZGV4X2dvb2RzP3BhZ2U9JHt0aGlzLnBhZ2V9JnBlcl9wYWdlPSR7dGhpcy5wZXJfcGFnZX1gKQ0KICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgIHRoaXMuZ29vZHNMaXN0cyA9IHRoaXMuZ29vZHNMaXN0cy5jb25jYXQocmVzLmRhdGEuZGF0YSkNCiAgICAgICAgICAvLyDliqDovb3nirbmgIHnu5PmnZ8NCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICAgIHRoaXMucGFnZSsrDQogICAgICAgICAgLy8g5pWw5o2u5YWo6YOo5Yqg6L295a6M5oiQDQogICAgICAgICAgaWYgKHJlcy5kYXRhLmRhdGEubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICB9LA0KICAgIGFkZENhcnQgKGlkKSB7DQogICAgICBsZXQgYWRkQ2FydExpc3QgPSB7DQogICAgICAgIGlkczogW2lkXSwNCiAgICAgICAgaW5mbzogew0KICAgICAgICAgIFtpZF06IHsNCiAgICAgICAgICAgIGNvdW50OiAxLA0KICAgICAgICAgICAgaXNjaGVja2VkOiBmYWxzZQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgbGV0IGNhcnRMaXN0ID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYXJ0TGlzdCcpDQogICAgICBpZiAoY2FydExpc3QgPT09IG51bGwpIHsNCiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYXJ0TGlzdCcsIEpTT04uc3RyaW5naWZ5KGFkZENhcnRMaXN0KSkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNhcnRMaXN0ID0gSlNPTi5wYXJzZShjYXJ0TGlzdCkNCiAgICAgICAgaWYgKGNhcnRMaXN0Lmlkcy5pbmRleE9mKGlkKSAhPT0gLTEpIHsNCiAgICAgICAgICBjYXJ0TGlzdC5pbmZvW2lkXS5jb3VudCsrDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgY2FydExpc3QuaWRzLnB1c2goaWQpDQogICAgICAgICAgY2FydExpc3QuaW5mb1tpZF0gPSB7DQogICAgICAgICAgICBjb3VudDogMSwNCiAgICAgICAgICAgIGlzY2hlY2tlZDogZmFsc2UNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYXJ0TGlzdCcsIEpTT04uc3RyaW5naWZ5KGNhcnRMaXN0KSkNCiAgICAgIH0NCiAgICAgIHRoaXMuY2FydE51bUNoYW5nZSgNCiAgICAgICAgSlNPTi5wYXJzZSh3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NhcnRMaXN0JykpLmlkcy5sZW5ndGgNCiAgICAgICkNCiAgICB9DQogIH0sDQogIGNyZWF0ZWQgKCkgew0KICAgIC8vIOiwg+eUqOaOpeWPo+iOt+WPlui9ruaSreWbvuaVsOaNrg0KICAgIHRoaXMuJGh0dHAuZ2V0KCcvbWFpbl9hZF9pbWFnZXMnKS50aGVuKHJlcyA9PiB7DQogICAgICB0aGlzLnNsaWRlc2hvd0xpc3QgPSByZXMuZGF0YS5kYXRhDQogICAgfSkNCiAgICAvLyDosIPnlKjmjqXlj6Pojrflj5bpppbpobXllYblk4HmjqjojZDliIbnsbsNCiAgICB0aGlzLiRodHRwLmdldCgnL2luZGV4X2NhdGVnb3JpZXMnKS50aGVuKHJlcyA9PiB7DQogICAgICB0aGlzLmdvb2RzQ2xhc3NlcyA9IHJlcy5kYXRhLmRhdGENCiAgICB9KQ0KICB9DQp9DQo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"home\">\r\n    <!-- 图片轮播图 -->\r\n    <van-row>\r\n      <van-swipe :autoplay=\"3000\" indicator-color=\"white\">\r\n        <van-swipe-item v-for=\"item in slideshowList\" :key=\"item.id\">\r\n          <van-image height=\"10rem\" fit=\"contain\" :src=\"item.image\" :to=\"item.link\" />\r\n        </van-swipe-item>\r\n      </van-swipe>\r\n    </van-row>\r\n    <!-- 推荐分类 -->\r\n    <van-row>\r\n      <van-grid :column-num=\"4\">\r\n        <van-grid-item v-for=\"item in goodsClasses\" :key=\"item.id\" :text=\"item.cat_name\" />\r\n      </van-grid>\r\n    </van-row>\r\n    <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"没有更多了\" @load=\"onLoad\">\r\n      <!-- 商品列表 -->\r\n      <van-row class=\"goodsList\" gutter=\"20\">\r\n        <van-col v-for=\"item in goodsLists\" :key=\"item.id\" :span=\"10\" class=\"goods_item\">\r\n          <van-image width=\"100\" height=\"100\" :src=\"item.image\" />\r\n          <div class=\"van-ellipsis goods_text\">{{item.goods_name}}</div>\r\n          <van-button type=\"warning\" size=\"small\" @click=\"addCart(item.id)\">加入购物车</van-button>\r\n          <p class=\"goods_price\">&yen;{{item.price}}</p>\r\n        </van-col>\r\n      </van-row>\r\n    </van-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations } from 'vuex'\r\nexport default {\r\n  data () {\r\n    return {\r\n      slideshowList: [],\r\n      goodsClasses: [],\r\n      goodsLists: [],\r\n      loading: false,\r\n      finished: false,\r\n      page: 1,\r\n      per_page: 20\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapMutations(['cartNumChange']),\r\n    onLoad () {\r\n      // 调用接口获取首页商品列表\r\n      this.$http\r\n        .get(`/index_goods?page=${this.page}&per_page=${this.per_page}`)\r\n        .then(res => {\r\n          this.goodsLists = this.goodsLists.concat(res.data.data)\r\n          // 加载状态结束\r\n          this.loading = false\r\n          this.page++\r\n          // 数据全部加载完成\r\n          if (res.data.data.length === 0) {\r\n            this.finished = true\r\n          }\r\n        })\r\n    },\r\n    addCart (id) {\r\n      let addCartList = {\r\n        ids: [id],\r\n        info: {\r\n          [id]: {\r\n            count: 1,\r\n            ischecked: false\r\n          }\r\n        }\r\n      }\r\n      let cartList = window.localStorage.getItem('cartList')\r\n      if (cartList === null) {\r\n        window.localStorage.setItem('cartList', JSON.stringify(addCartList))\r\n      } else {\r\n        cartList = JSON.parse(cartList)\r\n        if (cartList.ids.indexOf(id) !== -1) {\r\n          cartList.info[id].count++\r\n        } else {\r\n          cartList.ids.push(id)\r\n          cartList.info[id] = {\r\n            count: 1,\r\n            ischecked: false\r\n          }\r\n        }\r\n        window.localStorage.setItem('cartList', JSON.stringify(cartList))\r\n      }\r\n      this.cartNumChange(\r\n        JSON.parse(window.localStorage.getItem('cartList')).ids.length\r\n      )\r\n    }\r\n  },\r\n  created () {\r\n    // 调用接口获取轮播图数据\r\n    this.$http.get('/main_ad_images').then(res => {\r\n      this.slideshowList = res.data.data\r\n    })\r\n    // 调用接口获取首页商品推荐分类\r\n    this.$http.get('/index_categories').then(res => {\r\n      this.goodsClasses = res.data.data\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.home {\r\n  padding-bottom: 80px;\r\n}\r\n.goodsList {\r\n  padding: 20px 60px;\r\n}\r\n.goods_item {\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.goods_item:nth-child(even) {\r\n  margin-left: 30px;\r\n}\r\n.goods_text {\r\n  margin: 10px 0;\r\n}\r\n.goods_price {\r\n  margin: 0;\r\n  padding: 5px 0;\r\n  color: red;\r\n}\r\n</style>\r\n"]}]}