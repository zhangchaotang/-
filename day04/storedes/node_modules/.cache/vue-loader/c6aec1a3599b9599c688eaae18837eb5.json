{"remainingRequest":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\src\\views\\Home.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\src\\views\\Home.vue","mtime":1573195639873},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmhvbWUgewogIHBhZGRpbmctYm90dG9tOiA4MHB4Owp9Ci5nb29kc0xpc3QgewogIHBhZGRpbmc6IDIwcHggNjBweDsKfQouZ29vZHNfaXRlbSB7CiAgdGV4dC1hbGlnbjogY2VudGVyOwogIG1hcmdpbi1ib3R0b206IDIwcHg7Cn0KCi5nb29kc19pdGVtOm50aC1jaGlsZChldmVuKSB7CiAgbWFyZ2luLWxlZnQ6IDMwcHg7Cn0KLmdvb2RzX3RleHQgewogIG1hcmdpbjogMTBweCAwOwp9Ci5nb29kc19wcmljZSB7CiAgbWFyZ2luOiAwOwogIHBhZGRpbmc6IDVweCAwOwogIGNvbG9yOiByZWQ7Cn0K"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"home\">\n    <!-- 图片轮播图 -->\n    <van-row>\n      <van-swipe :autoplay=\"3000\" indicator-color=\"white\">\n        <van-swipe-item v-for=\"item in slideshowList\" :key=\"item.id\">\n          <van-image height=\"10rem\" fit=\"contain\" :src=\"item.image\" :to=\"item.link\" />\n        </van-swipe-item>\n      </van-swipe>\n    </van-row>\n    <!-- 推荐分类 -->\n    <van-row>\n      <van-grid :column-num=\"4\">\n        <van-grid-item v-for=\"item in goodsClasses\" :key=\"item.id\" :text=\"item.cat_name\" />\n      </van-grid>\n    </van-row>\n    <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"没有更多了\" @load=\"onLoad\">\n      <!-- 商品列表 -->\n      <van-row class=\"goodsList\" gutter=\"20\">\n        <van-col v-for=\"item in goodsLists\" :key=\"item.id\" :span=\"10\" class=\"goods_item\">\n          <van-image width=\"100\" height=\"100\" :src=\"item.image\" />\n          <div class=\"van-ellipsis goods_text\">{{item.goods_name}}</div>\n          <van-button type=\"warning\" size=\"small\" @click=\"addCart(item.id)\">加入购物车</van-button>\n          <p class=\"goods_price\">&yen;{{item.price}}</p>\n        </van-col>\n      </van-row>\n    </van-list>\n  </div>\n</template>\n\n<script>\nimport { mapMutations } from 'vuex'\nexport default {\n  data () {\n    return {\n      slideshowList: [],\n      goodsClasses: [],\n      goodsLists: [],\n      loading: false,\n      finished: false,\n      page: 1,\n      per_page: 20\n    }\n  },\n  methods: {\n    ...mapMutations(['cartNumChange']),\n    onLoad () {\n      // 调用接口获取首页商品列表\n      this.$http\n        .get(`/index_goods?page=${this.page}&per_page=${this.per_page}`)\n        .then(res => {\n          this.goodsLists = this.goodsLists.concat(res.data.data)\n          // 加载状态结束\n          this.loading = false\n          this.page++\n          // 数据全部加载完成\n          if (res.data.data.length === 0) {\n            this.finished = true\n          }\n        })\n    },\n    addCart (id) {\n      let addCartList = [{ id: id, num: 1, ischecked: false }]\n      let cartList = window.localStorage.getItem('cartList')\n      if (cartList === null) {\n        window.localStorage.setItem('cartList', JSON.stringify(addCartList))\n      } else {\n        cartList = JSON.parse(cartList)\n        let index = cartList.findIndex(item => {\n          return item.id === addCartList[0].id\n        })\n        if (index !== -1) {\n          cartList[index].num++\n          window.localStorage.setItem('cartList', JSON.stringify(cartList))\n        } else {\n          cartList = JSON.stringify(cartList.concat(addCartList))\n          window.localStorage.setItem('cartList', cartList)\n        }\n      }\n      this.cartNumChange(JSON.parse(window.localStorage.getItem('cartList')).length)\n    }\n  },\n  created () {\n    // 调用接口获取轮播图数据\n    this.$http.get('/main_ad_images').then(res => {\n      this.slideshowList = res.data.data\n    })\n    // 调用接口获取首页商品推荐分类\n    this.$http.get('/index_categories').then(res => {\n      this.goodsClasses = res.data.data\n    })\n  }\n}\n</script>\n\n<style>\n.home {\n  padding-bottom: 80px;\n}\n.goodsList {\n  padding: 20px 60px;\n}\n.goods_item {\n  text-align: center;\n  margin-bottom: 20px;\n}\n\n.goods_item:nth-child(even) {\n  margin-left: 30px;\n}\n.goods_text {\n  margin: 10px 0;\n}\n.goods_price {\n  margin: 0;\n  padding: 5px 0;\n  color: red;\n}\n</style>\n"]}]}