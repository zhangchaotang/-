{"remainingRequest":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\src\\views\\Home.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\src\\views\\Home.vue","mtime":1583589153911},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\css-loader\\dist\\cjs.js","mtime":1583588740845},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1583588770242},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\postcss-loader\\src\\index.js","mtime":1583588749703},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1583588729406},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\index.js","mtime":1583588770241}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5ob21lIHsNCiAgcGFkZGluZy1ib3R0b206IDgwcHg7DQp9DQouZ29vZHNMaXN0IHsNCiAgcGFkZGluZzogMjBweCA2MHB4Ow0KfQ0KLmdvb2RzX2l0ZW0gew0KICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogIG1hcmdpbi1ib3R0b206IDIwcHg7DQp9DQoNCi5nb29kc19pdGVtOm50aC1jaGlsZChldmVuKSB7DQogIG1hcmdpbi1sZWZ0OiAzMHB4Ow0KfQ0KLmdvb2RzX3RleHQgew0KICBtYXJnaW46IDEwcHggMDsNCn0NCi5nb29kc19wcmljZSB7DQogIG1hcmdpbjogMDsNCiAgcGFkZGluZzogNXB4IDA7DQogIGNvbG9yOiByZWQ7DQp9DQo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"home\">\r\n    <!-- 图片轮播图 -->\r\n    <van-row>\r\n      <van-swipe :autoplay=\"3000\" indicator-color=\"white\">\r\n        <van-swipe-item v-for=\"item in slideshowList\" :key=\"item.id\">\r\n          <van-image height=\"10rem\" fit=\"contain\" :src=\"item.image\" :to=\"item.link\" />\r\n        </van-swipe-item>\r\n      </van-swipe>\r\n    </van-row>\r\n    <!-- 推荐分类 -->\r\n    <van-row>\r\n      <van-grid :column-num=\"4\">\r\n        <van-grid-item v-for=\"item in goodsClasses\" :key=\"item.id\" :text=\"item.cat_name\" />\r\n      </van-grid>\r\n    </van-row>\r\n    <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"没有更多了\" @load=\"onLoad\">\r\n      <!-- 商品列表 -->\r\n      <van-row class=\"goodsList\" gutter=\"20\">\r\n        <van-col v-for=\"item in goodsLists\" :key=\"item.id\" :span=\"10\" class=\"goods_item\">\r\n          <van-image width=\"100\" height=\"100\" :src=\"item.image\" />\r\n          <div class=\"van-ellipsis goods_text\">{{item.goods_name}}</div>\r\n          <van-button type=\"warning\" size=\"small\" @click=\"addCart(item.id)\">加入购物车</van-button>\r\n          <p class=\"goods_price\">&yen;{{item.price}}</p>\r\n        </van-col>\r\n      </van-row>\r\n    </van-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations } from 'vuex'\r\nexport default {\r\n  data () {\r\n    return {\r\n      slideshowList: [],\r\n      goodsClasses: [],\r\n      goodsLists: [],\r\n      loading: false,\r\n      finished: false,\r\n      page: 1,\r\n      per_page: 20\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapMutations(['cartNumChange']),\r\n    onLoad () {\r\n      // 调用接口获取首页商品列表\r\n      this.$http\r\n        .get(`/index_goods?page=${this.page}&per_page=${this.per_page}`)\r\n        .then(res => {\r\n          this.goodsLists = this.goodsLists.concat(res.data.data)\r\n          // 加载状态结束\r\n          this.loading = false\r\n          this.page++\r\n          // 数据全部加载完成\r\n          if (res.data.data.length === 0) {\r\n            this.finished = true\r\n          }\r\n        })\r\n    },\r\n    addCart (id) {\r\n      console.log(id)\r\n      let addCartList = [{ id: id, num: 1, ischecked: false }]\r\n      let cartList = window.localStorage.getItem('cartList')\r\n      if (cartList === null) {\r\n        window.localStorage.setItem('cartList', JSON.stringify(addCartList))\r\n      } else {\r\n        cartList = JSON.parse(cartList)\r\n        let index = cartList.findIndex(item => {\r\n          return item.id === addCartList[0].id\r\n        })\r\n        if (index !== -1) {\r\n          cartList[index].num++\r\n          window.localStorage.setItem('cartList', JSON.stringify(cartList))\r\n        } else {\r\n          window.localStorage.setItem('cartList', JSON.stringify(cartList.concat(addCartList)))\r\n        }\r\n      }\r\n      this.cartNumChange(JSON.parse(window.localStorage.getItem('cartList')).length)\r\n    }\r\n  },\r\n  created () {\r\n    // 调用接口获取轮播图数据\r\n    this.$http.get('/main_ad_images').then(res => {\r\n      this.slideshowList = res.data.data\r\n    })\r\n    // 调用接口获取首页商品推荐分类\r\n    this.$http.get('/index_categories').then(res => {\r\n      this.goodsClasses = res.data.data\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.home {\r\n  padding-bottom: 80px;\r\n}\r\n.goodsList {\r\n  padding: 20px 60px;\r\n}\r\n.goods_item {\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.goods_item:nth-child(even) {\r\n  margin-left: 30px;\r\n}\r\n.goods_text {\r\n  margin: 10px 0;\r\n}\r\n.goods_price {\r\n  margin: 0;\r\n  padding: 5px 0;\r\n  color: red;\r\n}\r\n</style>\r\n"]}]}