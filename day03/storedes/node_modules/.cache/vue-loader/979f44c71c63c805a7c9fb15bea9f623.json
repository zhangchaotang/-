{"remainingRequest":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\src\\views\\Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\src\\views\\Home.vue","mtime":1583589153911},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1583588729406},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\babel-loader\\lib\\index.js","mtime":1583588727663},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1583588729406},{"path":"e:\\全栈\\semester_03\\semester_03\\day03\\storedes\\node_modules\\vue-loader\\lib\\index.js","mtime":1583588770241}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBtYXBNdXRhdGlvbnMgfSBmcm9tICd2dWV4Jw0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgc2xpZGVzaG93TGlzdDogW10sDQogICAgICBnb29kc0NsYXNzZXM6IFtdLA0KICAgICAgZ29vZHNMaXN0czogW10sDQogICAgICBsb2FkaW5nOiBmYWxzZSwNCiAgICAgIGZpbmlzaGVkOiBmYWxzZSwNCiAgICAgIHBhZ2U6IDEsDQogICAgICBwZXJfcGFnZTogMjANCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAuLi5tYXBNdXRhdGlvbnMoWydjYXJ0TnVtQ2hhbmdlJ10pLA0KICAgIG9uTG9hZCAoKSB7DQogICAgICAvLyDosIPnlKjmjqXlj6Pojrflj5bpppbpobXllYblk4HliJfooagNCiAgICAgIHRoaXMuJGh0dHANCiAgICAgICAgLmdldChgL2luZGV4X2dvb2RzP3BhZ2U9JHt0aGlzLnBhZ2V9JnBlcl9wYWdlPSR7dGhpcy5wZXJfcGFnZX1gKQ0KICAgICAgICAudGhlbihyZXMgPT4gew0KICAgICAgICAgIHRoaXMuZ29vZHNMaXN0cyA9IHRoaXMuZ29vZHNMaXN0cy5jb25jYXQocmVzLmRhdGEuZGF0YSkNCiAgICAgICAgICAvLyDliqDovb3nirbmgIHnu5PmnZ8NCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQ0KICAgICAgICAgIHRoaXMucGFnZSsrDQogICAgICAgICAgLy8g5pWw5o2u5YWo6YOo5Yqg6L295a6M5oiQDQogICAgICAgICAgaWYgKHJlcy5kYXRhLmRhdGEubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICB9LA0KICAgIGFkZENhcnQgKGlkKSB7DQogICAgICBjb25zb2xlLmxvZyhpZCkNCiAgICAgIGxldCBhZGRDYXJ0TGlzdCA9IFt7IGlkOiBpZCwgbnVtOiAxLCBpc2NoZWNrZWQ6IGZhbHNlIH1dDQogICAgICBsZXQgY2FydExpc3QgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NhcnRMaXN0JykNCiAgICAgIGlmIChjYXJ0TGlzdCA9PT0gbnVsbCkgew0KICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcnRMaXN0JywgSlNPTi5zdHJpbmdpZnkoYWRkQ2FydExpc3QpKQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgY2FydExpc3QgPSBKU09OLnBhcnNlKGNhcnRMaXN0KQ0KICAgICAgICBsZXQgaW5kZXggPSBjYXJ0TGlzdC5maW5kSW5kZXgoaXRlbSA9PiB7DQogICAgICAgICAgcmV0dXJuIGl0ZW0uaWQgPT09IGFkZENhcnRMaXN0WzBdLmlkDQogICAgICAgIH0pDQogICAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsNCiAgICAgICAgICBjYXJ0TGlzdFtpbmRleF0ubnVtKysNCiAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhcnRMaXN0JywgSlNPTi5zdHJpbmdpZnkoY2FydExpc3QpKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FydExpc3QnLCBKU09OLnN0cmluZ2lmeShjYXJ0TGlzdC5jb25jYXQoYWRkQ2FydExpc3QpKSkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgdGhpcy5jYXJ0TnVtQ2hhbmdlKEpTT04ucGFyc2Uod2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYXJ0TGlzdCcpKS5sZW5ndGgpDQogICAgfQ0KICB9LA0KICBjcmVhdGVkICgpIHsNCiAgICAvLyDosIPnlKjmjqXlj6Pojrflj5bova7mkq3lm77mlbDmja4NCiAgICB0aGlzLiRodHRwLmdldCgnL21haW5fYWRfaW1hZ2VzJykudGhlbihyZXMgPT4gew0KICAgICAgdGhpcy5zbGlkZXNob3dMaXN0ID0gcmVzLmRhdGEuZGF0YQ0KICAgIH0pDQogICAgLy8g6LCD55So5o6l5Y+j6I635Y+W6aaW6aG15ZWG5ZOB5o6o6I2Q5YiG57G7DQogICAgdGhpcy4kaHR0cC5nZXQoJy9pbmRleF9jYXRlZ29yaWVzJykudGhlbihyZXMgPT4gew0KICAgICAgdGhpcy5nb29kc0NsYXNzZXMgPSByZXMuZGF0YS5kYXRhDQogICAgfSkNCiAgfQ0KfQ0K"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"home\">\r\n    <!-- 图片轮播图 -->\r\n    <van-row>\r\n      <van-swipe :autoplay=\"3000\" indicator-color=\"white\">\r\n        <van-swipe-item v-for=\"item in slideshowList\" :key=\"item.id\">\r\n          <van-image height=\"10rem\" fit=\"contain\" :src=\"item.image\" :to=\"item.link\" />\r\n        </van-swipe-item>\r\n      </van-swipe>\r\n    </van-row>\r\n    <!-- 推荐分类 -->\r\n    <van-row>\r\n      <van-grid :column-num=\"4\">\r\n        <van-grid-item v-for=\"item in goodsClasses\" :key=\"item.id\" :text=\"item.cat_name\" />\r\n      </van-grid>\r\n    </van-row>\r\n    <van-list v-model=\"loading\" :finished=\"finished\" finished-text=\"没有更多了\" @load=\"onLoad\">\r\n      <!-- 商品列表 -->\r\n      <van-row class=\"goodsList\" gutter=\"20\">\r\n        <van-col v-for=\"item in goodsLists\" :key=\"item.id\" :span=\"10\" class=\"goods_item\">\r\n          <van-image width=\"100\" height=\"100\" :src=\"item.image\" />\r\n          <div class=\"van-ellipsis goods_text\">{{item.goods_name}}</div>\r\n          <van-button type=\"warning\" size=\"small\" @click=\"addCart(item.id)\">加入购物车</van-button>\r\n          <p class=\"goods_price\">&yen;{{item.price}}</p>\r\n        </van-col>\r\n      </van-row>\r\n    </van-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations } from 'vuex'\r\nexport default {\r\n  data () {\r\n    return {\r\n      slideshowList: [],\r\n      goodsClasses: [],\r\n      goodsLists: [],\r\n      loading: false,\r\n      finished: false,\r\n      page: 1,\r\n      per_page: 20\r\n    }\r\n  },\r\n  methods: {\r\n    ...mapMutations(['cartNumChange']),\r\n    onLoad () {\r\n      // 调用接口获取首页商品列表\r\n      this.$http\r\n        .get(`/index_goods?page=${this.page}&per_page=${this.per_page}`)\r\n        .then(res => {\r\n          this.goodsLists = this.goodsLists.concat(res.data.data)\r\n          // 加载状态结束\r\n          this.loading = false\r\n          this.page++\r\n          // 数据全部加载完成\r\n          if (res.data.data.length === 0) {\r\n            this.finished = true\r\n          }\r\n        })\r\n    },\r\n    addCart (id) {\r\n      console.log(id)\r\n      let addCartList = [{ id: id, num: 1, ischecked: false }]\r\n      let cartList = window.localStorage.getItem('cartList')\r\n      if (cartList === null) {\r\n        window.localStorage.setItem('cartList', JSON.stringify(addCartList))\r\n      } else {\r\n        cartList = JSON.parse(cartList)\r\n        let index = cartList.findIndex(item => {\r\n          return item.id === addCartList[0].id\r\n        })\r\n        if (index !== -1) {\r\n          cartList[index].num++\r\n          window.localStorage.setItem('cartList', JSON.stringify(cartList))\r\n        } else {\r\n          window.localStorage.setItem('cartList', JSON.stringify(cartList.concat(addCartList)))\r\n        }\r\n      }\r\n      this.cartNumChange(JSON.parse(window.localStorage.getItem('cartList')).length)\r\n    }\r\n  },\r\n  created () {\r\n    // 调用接口获取轮播图数据\r\n    this.$http.get('/main_ad_images').then(res => {\r\n      this.slideshowList = res.data.data\r\n    })\r\n    // 调用接口获取首页商品推荐分类\r\n    this.$http.get('/index_categories').then(res => {\r\n      this.goodsClasses = res.data.data\r\n    })\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.home {\r\n  padding-bottom: 80px;\r\n}\r\n.goodsList {\r\n  padding: 20px 60px;\r\n}\r\n.goods_item {\r\n  text-align: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.goods_item:nth-child(even) {\r\n  margin-left: 30px;\r\n}\r\n.goods_text {\r\n  margin: 10px 0;\r\n}\r\n.goods_price {\r\n  margin: 0;\r\n  padding: 5px 0;\r\n  color: red;\r\n}\r\n</style>\r\n"]}]}